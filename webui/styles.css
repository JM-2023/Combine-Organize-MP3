:root{
  --bg:#1a1a1a;
  --panel:#2a2a2a;
  --hover:#3a3a3a;
  --border:#3a3a3a;
  --text:#e0e0e0;
  --muted:#b0b0b0;
  --accent:#DC8862;
  --accentHover:#E59B7A;
  --danger:#d14a4a;

  --import:#DC8862;
  --convert:#6B89E5;
  --merge:#5FB86E;
  --silence:#B85F9E;
  --organize:#5FB8B8;
  --ui-scale:1;
}

*{ box-sizing:border-box; }
html,body{
  height:100%;
  overflow:hidden;
}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:var(--bg);
  color:var(--text);
  display:flex;
  flex-direction:column;
  min-height:0;
}

.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:16px 18px;
  border-bottom:1px solid var(--border);
  background:linear-gradient(180deg, rgba(42,42,42,0.9), rgba(26,26,26,0.9));
  position:sticky;
  top:0;
  z-index:10;
  backdrop-filter: blur(8px);
}
.brand .title{
  font-size:20px;
  font-weight:800;
  letter-spacing:0.2px;
  color:var(--accent);
}
.brand .subtitle{
  font-size:12px;
  color:var(--muted);
  margin-top:2px;
}
.status{
  display:flex;
  gap:10px;
  align-items:center;
}
.cwd{
  font-size:12px;
  color:var(--muted);
  max-width:48vw;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.pill{
  padding:6px 10px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--panel);
  font-size:12px;
  color:var(--muted);
}
.pill.busy{
  border-color:rgba(220,136,98,0.6);
  color:var(--text);
}

.layout{
  flex:1 1 auto;
  display:grid;
  grid-template-columns: 1fr 360px;
  grid-template-rows:minmax(0, 1fr);
  gap:14px;
  padding:14px;
  min-height:0;
  overflow:hidden;
}
@media (max-width: 980px){
  html,body{ overflow:auto; }
  body{
    display:block;
    min-height:100%;
  }
  .layout{
    grid-template-columns: 1fr;
    grid-template-rows:auto;
    min-height:auto;
    overflow:visible;
  }
  .files > .panelBody,
  .controls > .panelBody{
    overflow:visible;
    display:block;
    gap:0;
  }
}

.panel{
  display:flex;
  flex-direction:column;
  background:var(--panel);
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;
  min-height:0;
}
.panelHeader{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px 12px;
  border-bottom:1px solid var(--border);
}
.panelTitle{
  font-weight:700;
  color:var(--accent);
}
.panelBody{
  padding:12px;
  min-height:0;
}
.files > .panelBody{ overflow:auto; }
.controls > .panelBody{
  overflow:auto;
  padding:calc(12px * var(--ui-scale));
}
.controls .panelHeader{
  padding:calc(12px * var(--ui-scale));
}
.controls .panelTitle{
  font-size:calc(16px * var(--ui-scale));
}
.controls .group{
  padding:calc(12px * var(--ui-scale));
  border-radius:calc(12px * var(--ui-scale));
  margin-bottom:calc(12px * var(--ui-scale));
}
.controls .groupTitle{
  margin-bottom:calc(10px * var(--ui-scale));
  font-size:calc(16px * var(--ui-scale));
}
.controls .group .btn{
  margin-bottom:calc(8px * var(--ui-scale));
  padding:calc(10px * var(--ui-scale)) calc(12px * var(--ui-scale));
  border-radius:calc(10px * var(--ui-scale));
  font-size:calc(14px * var(--ui-scale));
}
.controls .row{
  gap:calc(8px * var(--ui-scale));
}
.controls .hint{
  font-size:calc(12px * var(--ui-scale));
}
.controls .settingsStatus{
  margin-top:calc(8px * var(--ui-scale));
}
.controls .field{
  margin-bottom:calc(10px * var(--ui-scale));
}
.controls .field .label{
  font-size:calc(12px * var(--ui-scale));
  margin-bottom:calc(6px * var(--ui-scale));
}
.controls select,
.controls input[type="number"],
.controls input[type="text"]{
  border-radius:calc(10px * var(--ui-scale));
  padding:calc(10px * var(--ui-scale));
  font-size:calc(14px * var(--ui-scale));
}
.controls .log{
  height:clamp(120px, calc(220px * var(--ui-scale)), 220px);
  border-radius:calc(12px * var(--ui-scale));
  padding:calc(10px * var(--ui-scale));
  font-size:calc(12px * var(--ui-scale));
}

.btn{
  border:0;
  border-radius:10px;
  padding:10px 12px;
  cursor:pointer;
  color:white;
  font-weight:600;
  background:var(--accent);
}
.btn:hover{ filter:brightness(1.05); }
.btn:disabled{
  cursor:not-allowed;
  background:var(--border);
  color:var(--muted);
}
.btn.secondary{
  background:transparent;
  border:1px solid var(--accent);
  color:var(--text);
}
.btn.secondary:hover{
  background:rgba(220,136,98,0.08);
}
.btn.action.import{ background:var(--import); }
.btn.action.convert{ background:var(--convert); }
.btn.action.merge{ background:var(--merge); }
.btn.action.silence{ background:var(--silence); }
.btn.action.organize{ background:var(--organize); }

.group{ padding:12px; border:1px solid var(--border); border-radius:12px; margin-bottom:12px; background:rgba(26,26,26,0.35); }
.groupTitle{ font-weight:800; color:var(--accent); margin-bottom:10px; }
.group .btn{ width:100%; margin-bottom:8px; }
.row{ display:flex; gap:8px; }
.row .btn{ flex:1; }
.hint{ font-size:12px; color:var(--muted); margin-top:2px; }
.settingsStatus{
  margin-top:8px;
  line-height:1.4;
}
.settingsStatus.status-pending{ color:#f0c36d; }
.settingsStatus.status-saving{ color:#89b3ff; }
.settingsStatus.status-ok{ color:#82d49a; }
.settingsStatus.status-error{ color:#ff8f8f; }

.field{ display:block; margin-bottom:10px; }
.field .label{ font-size:12px; color:var(--muted); margin-bottom:6px; }
select, input[type="number"], input[type="text"]{
  width:100%;
  border-radius:10px;
  border:1px solid var(--border);
  background:var(--bg);
  color:var(--text);
  padding:10px 10px;
  outline:none;
}
select:focus, input:focus{ border-color:rgba(220,136,98,0.7); }

.filesRoot{
  display:flex;
  flex-direction:column;
  gap:12px;
}

.dateGroup{
  border:1px solid var(--border);
  border-radius:12px;
  overflow:hidden;
}
.dateHeader{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 10px;
  background:rgba(26,26,26,0.4);
  border-bottom:1px solid var(--border);
}
.dateTitle{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:800;
}
.swatch{
  width:10px; height:10px; border-radius:999px; border:1px solid rgba(255,255,255,0.12);
}
.dateActions{ display:flex; gap:8px; align-items:center; }
.dateActions .btn{ width:auto; padding:8px 10px; border-radius:10px; }

.fileRow{
  display:grid;
  grid-template-columns: 26px minmax(0, 1fr) 76px 92px 72px;
  gap:10px;
  align-items:center;
  padding:8px 10px;
  border-bottom:1px solid rgba(58,58,58,0.65);
}
.fileRow > *{ min-width:0; }
.fileRow:last-child{ border-bottom:0; }
.fileRow:hover{ background:rgba(58,58,58,0.35); }
.fileRow.disabled{ opacity:0.55; }
.fileName{
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
.fileMeta{ font-size:12px; color:var(--muted); text-align:right; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.stateTag{
  display:block;
  font-size:12px;
  padding:4px 8px;
  border-radius:999px;
  border:1px solid var(--border);
  color:var(--muted);
  text-align:right;
  justify-self:stretch;
  width:100%;
  max-width:100%;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.stateTag.output{ border-color:rgba(95,184,110,0.6); color:rgba(95,184,110,0.9); }
.stateTag.merged{ border-color:rgba(120,120,120,0.6); }
.stateTag.converted{ border-color:rgba(107,137,229,0.55); }

.fileRow.style-merged .fileName{ text-decoration: line-through; color: #505050; }
.fileRow.style-output .fileName{ font-weight: 800; color: rgba(95,184,110,0.95); }
.fileRow.style-converted .fileName{ color: #969696; }

.log{
  height:220px;
  overflow:auto;
  background:var(--bg);
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  font-size:12px;
  white-space:pre-wrap;
}

.dialog::backdrop{ background:rgba(0,0,0,0.55); }
.dialog{
  border:1px solid var(--border);
  border-radius:14px;
  padding:0;
  background:var(--panel);
  color:var(--text);
  width:min(680px, 92vw);
}
.dialogForm{ padding:14px; }
.dialogTitle{ font-size:16px; font-weight:900; color:var(--accent); margin-bottom:10px; }
.dialogText{ font-size:12px; color:var(--muted); margin-bottom:12px; line-height:1.4; }
.dialogActions{ display:flex; gap:10px; justify-content:flex-end; margin-top:10px; }
.dialogActions .btn{ width:auto; }
